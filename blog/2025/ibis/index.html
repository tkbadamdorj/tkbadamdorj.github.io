<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> No more SQL: using ibis as a machine learning researcher | Taivanbat Badamdorj (TK) </title> <meta name="author" content="Taivanbat Badamdorj"> <meta name="description" content="How to give in to your fears of SQL and/or possibly improve your life"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tkbadamdorj.github.io/blog/2025/ibis/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Taivanbat Badamdorj (TK) </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">No more SQL: using ibis as a machine learning researcher</h1> <p class="post-meta"> Created in January 20, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/data-engineering"> <i class="fa-solid fa-hashtag fa-sm"></i> data-engineering</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="tldr">TL;DR:</h1> <ul> <li>I am afraid of SQL</li> <li> <a href="https://pandas.pydata.org/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">pandas</code></a> <em>was</em> great until it wasn’t <ul> <li>it doesn’t do so well with large scale data</li> </ul> </li> <li> <a href="https://duckdb.org/" rel="external nofollow noopener" target="_blank">duckdb</a> gives you a powerful backend for dealing with larger scale data, but you need to know SQL</li> <li> <a href="https://ibis-project.org/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">ibis</code></a> lets you use pythonic, pandas-like syntax while letting you use duckdb as a backend <ul> <li>in total they have 20+ backends (also including polars and other SQL backends)</li> <li>using <code class="language-plaintext highlighter-rouge">ibis</code> lets you write and execute complicated SQL queries in a pythonic way</li> </ul> </li> </ul> <hr> <h3 id="ml-researchers-have-low-self-esteem-because-they-cant-write-sql">ML researchers have low self-esteem because they can’t write SQL</h3> <p>The machine learning researcher pipeline goes: you get really good grades in university, go to grad school, work on common benchmark datasets with a huge focus improving the state-of-the-art by developing new algorithms.</p> <p>If you’re really bold, you collect and annotate your own dataset.</p> <p>Then you go to a company and you feel bad.</p> <p>“What? I have to access this table where? How do I query it? How do I transform it to get it into the format I want? How can I explore this? It doesn’t fit into memory as a lovely <code class="language-plaintext highlighter-rouge">DataFrame</code> that I can manipulate how I want to.”</p> <p>You’re stuck. You used to be a somebody.</p> <p>“If only… if only someone smarter than me wrote a tool that has a simple pythonic, pandas-like API that lets me do all the cool stuff the data engineers do,” you think to yourself.</p> <p>You look up. The data engineers are doing kickflips outside.</p> <h3 id="why-isnt-pandas-sufficient">Why isn’t <code class="language-plaintext highlighter-rouge">pandas</code> sufficient?</h3> <p><code class="language-plaintext highlighter-rouge">pandas</code> is the de-facto library that researchers have come to love and use. With its trove of useful functions and simple python syntax, it’s great when you’re not dealing with large scale data.</p> <p>As Wes McKinney, the creator of pandas says in “10 Things I Hate About Pandas” (<a href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/" rel="external nofollow noopener" target="_blank">link</a>), his rule of thumb for pandas is that you should have <strong>5 to 10 times as much RAM</strong> as the size of your dataset. When you’re dealing with terabytes of data, this is impossible to achieve.</p> <p>In summary:</p> <ul> <li>ease of use ✅</li> <li>processing large scale data ❌</li> </ul> <h3 id="i-heard-a-quack-enter-duckdb">I heard a quack: enter <code class="language-plaintext highlighter-rouge">duckdb</code> </h3> <p><a href="https://duckdb.org/" rel="external nofollow noopener" target="_blank">duckdb</a> on the other hand is an open source database system. You can query and transform your data anywhere, and as the website says, you can process larger-than-memory workloads! It’s a much better alternative to pandas in terms of dealing with large scale data, but you need to know SQL. For example, to get the average bill length and maximum flipper length for each group of birds (by species and island), the SQL query looks like the following:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get average bill length and maximum flipper length
</span><span class="kn">import</span> <span class="n">duckdb</span>
<span class="n">duckdb</span><span class="p">.</span><span class="nf">sql</span><span class="p">(</span><span class="sh">"""</span><span class="s">
	SELECT 
	    species, 
	    island, 
	    AVG(bill_length_mm) AS </span><span class="sh">"</span><span class="s">Mean(bill_length_mm)</span><span class="sh">"</span><span class="s">, 
	    MAX(flipper_length_mm) AS </span><span class="sh">"</span><span class="s">Max(flipper_length_mm)</span><span class="sh">"</span><span class="s">
	FROM penguins
	GROUP BY species, island
    </span><span class="sh">"""</span><span class="p">)</span>
</code></pre></div></div> <p>Writing SQL inside of a python string is ok, but maybe not the prettiest.</p> <p>In summary:</p> <ul> <li>ease of use ❌ (if you don’t know SQL)</li> <li>processing large scale data ✅</li> </ul> <h3 id="the-ibis-has-landed">The <code class="language-plaintext highlighter-rouge">ibis</code> has landed</h3> <p>Thankfully, there’s a third alternative that combines ease of use with the ability to process large scale data.</p> <p><a href="https://ibis-project.org/why" rel="external nofollow noopener" target="_blank">ibis</a> is a python package that acts as an interface between you and the query engine. ibis supports over 20 query engines including duckdb. On top of that they support polars, BiqQuery, ClickHouse, MySQL, PostgreSQL, and a variety of others!</p> <p>The whole philosophy behind ibis is to create a common user interface for all the different query engines. You can change what query engine to use without changing any of your ibis code.</p> <p>With <code class="language-plaintext highlighter-rouge">ibis</code>, we can rewrite the example above in a much more pythonic way:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">ibis</span>
<span class="p">(</span>
    <span class="n">penguins</span>
    <span class="p">.</span><span class="nf">group_by</span><span class="p">([</span><span class="n">penguins</span><span class="p">.</span><span class="n">species</span><span class="p">,</span> <span class="n">penguins</span><span class="p">.</span><span class="n">island</span><span class="p">])</span>
    <span class="p">.</span><span class="nf">aggregate</span><span class="p">(</span>
	<span class="p">[</span>
	    <span class="n">penguins</span><span class="p">.</span><span class="n">bill_length_mm</span><span class="p">.</span><span class="nf">mean</span><span class="p">(),</span> 
	    <span class="n">penguins</span><span class="p">.</span><span class="n">flipper_length_mm</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span>
	<span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div> <p>I found the syntax much more friendly compared to duckdb. Since the backend uses duckdb, we also don’t lose out on any performance benefits by using ibis.</p> <p>ibis thus meets the two things we were looking for:</p> <ul> <li>ease of use ✅</li> <li>processing large scale data ✅</li> </ul> <p>Another benefit of ibis is that since it is query engine-agnostic, if one of the query engines develops a new feature that is way faster than the others, you don’t have to rewrite your ibis code! You can just change the backend.</p> <h3 id="you-can-pretend-to-be-a-cool-data-engineer-now">You can pretend to be a cool data engineer now</h3> <p>Now that you know about <code class="language-plaintext highlighter-rouge">ibis</code> you can do some of the things that the cool skateboarding data engineers can do. You won’t be able to do all the cool things they can do, but hey at least you won’t embarrass yourself any further.</p> <p>Give ibis a try! I found the <code class="language-plaintext highlighter-rouge">ibis</code> tutorials <a href="https://ibis-project.org/tutorials/getting_started#group_by" rel="external nofollow noopener" target="_blank">here</a> very useful.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/pants/">Cutting our CI test load by 60% on top of pants' built-in optimizations</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Taivanbat Badamdorj. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>